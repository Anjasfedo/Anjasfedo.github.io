---
import Layout from "../../layouts/Layout.astro";
import { ProjectDetail } from "../../components/ProjectDetail";
import { getCollection, render } from "astro:content";

// Generate static paths for all projects
export async function getStaticPaths() {
  const projects = await getCollection("projects");

  return projects.map((project) => ({
    params: { slug: project.data.slug },
    props: { project },
  }));
}

// Get the project from props (returned by getStaticPaths)
const { project } = Astro.props;
const { Content } = await render(project);

// Set page metadata
const title = `${project.data.title} | Project | M. Anjasfedo Afridiansah`;
const description = project.data.description;
---

<Layout title={title}>
  <div class="relative min-h-screen w-full bg-white dark:bg-black overflow-hidden">
    {/* Grid Background */}
    <div
      class="absolute inset-0 [background-size:20px_20px] [background-image:linear-gradient(to_right,#e4e4e7_1px,transparent_1px),linear-gradient(to_bottom,#e4e4e7_1px,transparent_1px)] dark:[background-image:linear-gradient(to_right,#262626_1px,transparent_1px),linear-gradient(to_bottom,#262626_1px,transparent_1px)]"
    />
    {/* Radial gradient for the container to give a faded look */}
    <div class="pointer-events-none absolute inset-0 flex items-center justify-center bg-white [mask-image:radial-gradient(ellipse_at_center,transparent_20%,black)] dark:bg-black"></div>

    <div class="relative z-10">
      <ProjectDetail
        client:load
        project={{
          id: project.id,
          slug: project.slug,
          name: project.data.title,
          description: project.data.description,
          longDescription: project.data.longDescription,
          status: project.data.status,
          tags: project.data.tags,
          image: project.data.image,
          images: project.data.images,
          video: project.data.video,
          colorClass: project.data.colorClass,
          github: project.data.github,
          demo: project.data.demo,
        }}
      />

      <!-- Render MDX content below the project details with TracingBeam -->
      <div class="bg-white dark:bg-black">
        <div class="max-w-7xl mx-auto px-6 py-16">
          <div class="prose prose-lg prose-neutral dark:prose-invert max-w-none prose-headings:font-bold prose-p:leading-relaxed prose-img:rounded-xl">
            <Content />
          </div>
        </div>
      </div>
    </div>
  </div>
</Layout>
